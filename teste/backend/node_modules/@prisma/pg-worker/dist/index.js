"use strict";var Ks=Object.create;var me=Object.defineProperty;var zs=Object.getOwnPropertyDescriptor;var Vs=Object.getOwnPropertyNames;var Ys=Object.getPrototypeOf,$s=Object.prototype.hasOwnProperty;var D=(r,e)=>()=>(r&&(e=r(r=0)),e);var w=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),ye=(r,e)=>{for(var t in e)me(r,t,{get:e[t],enumerable:!0})},pe=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Vs(e))!$s.call(r,n)&&n!==t&&me(r,n,{get:()=>e[n],enumerable:!(s=zs(e,n))||s.enumerable});return r},_=(r,e,t)=>(pe(r,e,"default"),t&&pe(t,e,"default")),ge=(r,e,t)=>(t=r!=null?Ks(Ys(r)):{},pe(e||!r||!r.__esModule?me(t,"default",{value:r,enumerable:!0}):t,r)),P=r=>pe(me({},"__esModule",{value:!0}),r);var f,o=D(()=>{"use strict";f={nextTick:(r,...e)=>{setTimeout(()=>{r(...e)},0)},env:{},version:"",cwd:()=>"/",stderr:{},argv:["/bin/node"],pid:1e4}});var m,u=D(()=>{"use strict";m=globalThis.performance??(()=>{let r=Date.now();return{now:()=>Date.now()-r}})()});var h,c=D(()=>{"use strict";h=require("node:buffer")});var R={};var z=D(()=>{"use strict";o();u();c();_(R,require("node:events"))});var Be=w(Wt=>{"use strict";o();u();c();Wt.parse=function(r,e){return new qe(r,e).parse()};var qe=class r{constructor(e,t){this.source=e,this.transform=t||Js,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var t;(this.recorded.length>0||e)&&(t=this.recorded.join(""),t==="NULL"&&!e&&(t=null),t!==null&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var t,s,n;for(this.consumeDimensions();!this.isEof();)if(t=this.nextCharacter(),t.value==="{"&&!n)this.dimension++,this.dimension>1&&(s=new r(this.source.substr(this.position-1),this.transform),this.entries.push(s.parse(!0)),this.position+=s.position-2);else if(t.value==="}"&&!n){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else t.value==='"'&&!t.escaped?(n&&this.newEntry(!0),n=!n):t.value===","&&!n?this.newEntry():this.record(t.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function Js(r){return r}});var Fe=w((wo,Kt)=>{"use strict";o();u();c();var Zs=Be();Kt.exports={create:function(r,e){return{parse:function(){return Zs.parse(r,e)}}}}});var Yt=w((Eo,Vt)=>{"use strict";o();u();c();var Xs=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,en=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,tn=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,rn=/^-?infinity$/;Vt.exports=function(e){if(rn.test(e))return Number(e.replace("i","I"));var t=Xs.exec(e);if(!t)return sn(e)||null;var s=!!t[8],n=parseInt(t[1],10);s&&(n=zt(n));var i=parseInt(t[2],10)-1,a=t[3],l=parseInt(t[4],10),p=parseInt(t[5],10),d=parseInt(t[6],10),S=t[7];S=S?1e3*parseFloat(S):0;var v,b=nn(e);return b!=null?(v=new Date(Date.UTC(n,i,a,l,p,d,S)),Ne(n)&&v.setUTCFullYear(n),b!==0&&v.setTime(v.getTime()-b)):(v=new Date(n,i,a,l,p,d,S),Ne(n)&&v.setFullYear(n)),v};function sn(r){var e=en.exec(r);if(e){var t=parseInt(e[1],10),s=!!e[4];s&&(t=zt(t));var n=parseInt(e[2],10)-1,i=e[3],a=new Date(t,n,i);return Ne(t)&&a.setFullYear(t),a}}function nn(r){if(r.endsWith("+00"))return 0;var e=tn.exec(r.split(" ")[1]);if(e){var t=e[1];if(t==="Z")return 0;var s=t==="-"?-1:1,n=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return n*s*1e3}}function zt(r){return-(r-1)}function Ne(r){return r>=0&&r<100}});var Jt=w((Po,$t)=>{"use strict";o();u();c();$t.exports=on;var an=Object.prototype.hasOwnProperty;function on(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)an.call(t,s)&&(r[s]=t[s])}return r}});var er=w((Ro,Xt)=>{"use strict";o();u();c();var un=Jt();Xt.exports=V;function V(r){if(!(this instanceof V))return new V(r);un(this,_n(r))}var cn=["seconds","minutes","hours","days","months","years"];V.prototype.toPostgres=function(){var r=cn.filter(this.hasOwnProperty,this);return this.milliseconds&&r.indexOf("seconds")<0&&r.push("seconds"),r.length===0?"0":r.map(function(e){var t=this[e]||0;return e==="seconds"&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e},this).join(" ")};var hn={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},ln=["years","months","days"],fn=["hours","minutes","seconds"];V.prototype.toISOString=V.prototype.toISO=function(){var r=ln.map(t,this).join(""),e=fn.map(t,this).join("");return"P"+r+"T"+e;function t(s){var n=this[s]||0;return s==="seconds"&&this.milliseconds&&(n=(n+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),n+hn[s]}};var Qe="([+-]?\\d+)",dn=Qe+"\\s+years?",pn=Qe+"\\s+mons?",mn=Qe+"\\s+days?",yn="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",gn=new RegExp([dn,pn,mn,yn].map(function(r){return"("+r+")?"}).join("\\s*")),Zt={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},Sn=["hours","minutes","seconds","milliseconds"];function wn(r){var e=r+"000000".slice(r.length);return parseInt(e,10)/1e3}function _n(r){if(!r)return{};var e=gn.exec(r),t=e[8]==="-";return Object.keys(Zt).reduce(function(s,n){var i=Zt[n],a=e[i];return!a||(a=n==="milliseconds"?wn(a):parseInt(a,10),!a)||(t&&~Sn.indexOf(n)&&(a*=-1),s[n]=a),s},{})}});var rr=w((Oo,tr)=>{"use strict";o();u();c();tr.exports=function(e){if(/^\\x/.test(e))return new h.Buffer(e.substr(2),"hex");for(var t="",s=0;s<e.length;)if(e[s]!=="\\")t+=e[s],++s;else if(/[0-7]{3}/.test(e.substr(s+1,3)))t+=String.fromCharCode(parseInt(e.substr(s+1,3),8)),s+=4;else{for(var n=1;s+n<e.length&&e[s+n]==="\\";)n++;for(var i=0;i<Math.floor(n/2);++i)t+="\\";s+=Math.floor(n/2)*2}return new h.Buffer(t,"binary")}});var cr=w((No,ur)=>{"use strict";o();u();c();var re=Be(),se=Fe(),Se=Yt(),nr=er(),ir=rr();function we(r){return function(t){return t===null?t:r(t)}}function ar(r){return r===null?r:r==="TRUE"||r==="t"||r==="true"||r==="y"||r==="yes"||r==="on"||r==="1"}function vn(r){return r?re.parse(r,ar):null}function bn(r){return parseInt(r,10)}function Ue(r){return r?re.parse(r,we(bn)):null}function En(r){return r?re.parse(r,we(function(e){return or(e).trim()})):null}var Cn=function(r){if(!r)return null;var e=se.create(r,function(t){return t!==null&&(t=We(t)),t});return e.parse()},He=function(r){if(!r)return null;var e=se.create(r,function(t){return t!==null&&(t=parseFloat(t)),t});return e.parse()},L=function(r){if(!r)return null;var e=se.create(r);return e.parse()},je=function(r){if(!r)return null;var e=se.create(r,function(t){return t!==null&&(t=Se(t)),t});return e.parse()},An=function(r){if(!r)return null;var e=se.create(r,function(t){return t!==null&&(t=nr(t)),t});return e.parse()},xn=function(r){return r?re.parse(r,we(ir)):null},Ge=function(r){return parseInt(r,10)},or=function(r){var e=String(r);return/^\d+$/.test(e)?e:r},sr=function(r){return r?re.parse(r,we(JSON.parse)):null},We=function(r){return r[0]!=="("?null:(r=r.substring(1,r.length-1).split(","),{x:parseFloat(r[0]),y:parseFloat(r[1])})},Pn=function(r){if(r[0]!=="<"&&r[1]!=="(")return null;for(var e="(",t="",s=!1,n=2;n<r.length-1;n++){if(s||(e+=r[n]),r[n]===")"){s=!0;continue}else if(!s)continue;r[n]!==","&&(t+=r[n])}var i=We(e);return i.radius=parseFloat(t),i},Mn=function(r){r(20,or),r(21,Ge),r(23,Ge),r(26,Ge),r(700,parseFloat),r(701,parseFloat),r(16,ar),r(1082,Se),r(1114,Se),r(1184,Se),r(600,We),r(651,L),r(718,Pn),r(1e3,vn),r(1001,xn),r(1005,Ue),r(1007,Ue),r(1028,Ue),r(1016,En),r(1017,Cn),r(1021,He),r(1022,He),r(1231,He),r(1014,L),r(1015,L),r(1008,L),r(1009,L),r(1040,L),r(1041,L),r(1115,je),r(1182,je),r(1185,je),r(1186,nr),r(1187,An),r(17,ir),r(114,JSON.parse.bind(JSON)),r(3802,JSON.parse.bind(JSON)),r(199,sr),r(3807,sr),r(3907,L),r(2951,L),r(791,L),r(1183,L),r(1270,L)};ur.exports={init:Mn}});var lr=w((jo,hr)=>{"use strict";o();u();c();var T=1e6;function Tn(r){var e=r.readInt32BE(0),t=r.readUInt32BE(4),s="";e<0&&(e=~e+(t===0),t=~t+1>>>0,s="-");var n="",i,a,l,p,d,S;{if(i=e%T,e=e/T>>>0,a=4294967296*i+t,t=a/T>>>0,l=""+(a-T*t),t===0&&e===0)return s+l+n;for(p="",d=6-l.length,S=0;S<d;S++)p+="0";n=p+l+n}{if(i=e%T,e=e/T>>>0,a=4294967296*i+t,t=a/T>>>0,l=""+(a-T*t),t===0&&e===0)return s+l+n;for(p="",d=6-l.length,S=0;S<d;S++)p+="0";n=p+l+n}{if(i=e%T,e=e/T>>>0,a=4294967296*i+t,t=a/T>>>0,l=""+(a-T*t),t===0&&e===0)return s+l+n;for(p="",d=6-l.length,S=0;S<d;S++)p+="0";n=p+l+n}return i=e%T,a=4294967296*i+t,l=""+a%T,s+l+n}hr.exports=Tn});var yr=w((zo,mr)=>{"use strict";o();u();c();var In=lr(),E=function(r,e,t,s,n){t=t||0,s=s||!1,n=n||function(I,Le,Oe){return I*Math.pow(2,Oe)+Le};var i=t>>3,a=function(I){return s?~I&255:I},l=255,p=8-t%8;e<p&&(l=255<<8-e&255,p=e),t&&(l=l>>t%8);var d=0;t%8+e>=8&&(d=n(0,a(r[i])&l,p));for(var S=e+t>>3,v=i+1;v<S;v++)d=n(d,a(r[v]),8);var b=(e+t)%8;return b>0&&(d=n(d,a(r[S])>>8-b,b)),d},pr=function(r,e,t){var s=Math.pow(2,t-1)-1,n=E(r,1),i=E(r,t,1);if(i===0)return 0;var a=1,l=function(d,S,v){d===0&&(d=1);for(var b=1;b<=v;b++)a/=2,(S&1<<v-b)>0&&(d+=a);return d},p=E(r,e,t+1,!1,l);return i==Math.pow(2,t+1)-1?p===0?n===0?1/0:-1/0:NaN:(n===0?1:-1)*Math.pow(2,i-s)*p},Rn=function(r){return E(r,1)==1?-1*(E(r,15,1,!0)+1):E(r,15,1)},fr=function(r){return E(r,1)==1?-1*(E(r,31,1,!0)+1):E(r,31,1)},kn=function(r){return pr(r,23,8)},Dn=function(r){return pr(r,52,11)},Ln=function(r){var e=E(r,16,32);if(e==49152)return NaN;for(var t=Math.pow(1e4,E(r,16,16)),s=0,n=[],i=E(r,16),a=0;a<i;a++)s+=E(r,16,64+16*a)*t,t/=1e4;var l=Math.pow(10,E(r,16,48));return(e===0?1:-1)*Math.round(s*l)/l},dr=function(r,e){var t=E(e,1),s=E(e,63,1),n=new Date((t===0?1:-1)*s/1e3+9466848e5);return r||n.setTime(n.getTime()+n.getTimezoneOffset()*6e4),n.usec=s%1e3,n.getMicroSeconds=function(){return this.usec},n.setMicroSeconds=function(i){this.usec=i},n.getUTCMicroSeconds=function(){return this.usec},n},ne=function(r){for(var e=E(r,32),t=E(r,32,32),s=E(r,32,64),n=96,i=[],a=0;a<e;a++)i[a]=E(r,32,n),n+=32,n+=32;var l=function(d){var S=E(r,32,n);if(n+=32,S==4294967295)return null;var v;if(d==23||d==20)return v=E(r,S*8,n),n+=S*8,v;if(d==25)return v=r.toString(this.encoding,n>>3,(n+=S<<3)>>3),v;console.log("ERROR: ElementType not implemented: "+d)},p=function(d,S){var v=[],b;if(d.length>1){var I=d.shift();for(b=0;b<I;b++)v[b]=p(d,S);d.unshift(I)}else for(b=0;b<d[0];b++)v[b]=l(S);return v};return p(i,s)},On=function(r){return r.toString("utf8")},qn=function(r){return r===null?null:E(r,8)>0},Bn=function(r){r(20,In),r(21,Rn),r(23,fr),r(26,fr),r(1700,Ln),r(700,kn),r(701,Dn),r(16,qn),r(1114,dr.bind(null,!1)),r(1184,dr.bind(null,!0)),r(1e3,ne),r(1007,ne),r(1016,ne),r(1008,ne),r(1009,ne),r(25,On)};mr.exports={init:Bn}});var Sr=w((Jo,gr)=>{"use strict";o();u();c();gr.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var oe=w(ae=>{"use strict";o();u();c();var Fn=cr(),Nn=yr(),Qn=Fe(),Un=Sr();ae.getTypeParser=Hn;ae.setTypeParser=jn;ae.arrayParser=Qn;ae.builtins=Un;var ie={text:{},binary:{}};function wr(r){return String(r)}function Hn(r,e){return e=e||"text",ie[e]&&ie[e][r]||wr}function jn(r,e,t){typeof e=="function"&&(t=e,e="text"),ie[e][r]=t}Fn.init(function(r,e){ie.text[r]=e});Nn.init(function(r,e){ie.binary[r]=e})});var ue=w((iu,Ke)=>{"use strict";o();u();c();Ke.exports={host:"localhost",user:f.platform==="win32"?f.env.USERNAME:f.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var Y=oe(),Gn=Y.getTypeParser(20,"text"),Wn=Y.getTypeParser(1016,"text");Ke.exports.__defineSetter__("parseInt8",function(r){Y.setTypeParser(20,"text",r?Y.getTypeParser(23,"text"):Gn),Y.setTypeParser(1016,"text",r?Y.getTypeParser(1007,"text"):Wn)})});var ve=w((cu,vr)=>{"use strict";o();u();c();var Kn=ue();function zn(r){var e=r.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+e+'"'}function _r(r){for(var e="{",t=0;t<r.length;t++)if(t>0&&(e=e+","),r[t]===null||typeof r[t]>"u")e=e+"NULL";else if(Array.isArray(r[t]))e=e+_r(r[t]);else if(ArrayBuffer.isView(r[t])){var s=r[t];if(!(s instanceof h.Buffer)){var n=h.Buffer.from(s.buffer,s.byteOffset,s.byteLength);n.length===s.byteLength?s=n:s=n.slice(s.byteOffset,s.byteOffset+s.byteLength)}e+="\\\\x"+s.toString("hex")}else e+=zn(_e(r[t]));return e=e+"}",e}var _e=function(r,e){if(r==null)return null;if(typeof r=="object"){if(r instanceof h.Buffer)return r;if(ArrayBuffer.isView(r)){var t=h.Buffer.from(r.buffer,r.byteOffset,r.byteLength);return t.length===r.byteLength?t:t.slice(r.byteOffset,r.byteOffset+r.byteLength)}return r instanceof Date?Kn.parseInputDatesAsUTC?$n(r):Yn(r):Array.isArray(r)?_r(r):Vn(r,e)}return r.toString()};function Vn(r,e){if(r&&typeof r.toPostgres=="function"){if(e=e||[],e.indexOf(r)!==-1)throw new Error('circular reference detected while preparing "'+r+'" for query');return e.push(r),_e(r.toPostgres(_e),e)}return JSON.stringify(r)}function Yn(r){var e=-r.getTimezoneOffset(),t=r.getFullYear(),s=t<1;s&&(t=Math.abs(t)+1);var n=String(t).padStart(4,"0")+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+String(r.getMilliseconds()).padStart(3,"0");return e<0?(n+="-",e*=-1):n+="+",n+=String(Math.floor(e/60)).padStart(2,"0")+":"+String(e%60).padStart(2,"0"),s&&(n+=" BC"),n}function $n(r){var e=r.getUTCFullYear(),t=e<1;t&&(e=Math.abs(e)+1);var s=String(e).padStart(4,"0")+"-"+String(r.getUTCMonth()+1).padStart(2,"0")+"-"+String(r.getUTCDate()).padStart(2,"0")+"T"+String(r.getUTCHours()).padStart(2,"0")+":"+String(r.getUTCMinutes()).padStart(2,"0")+":"+String(r.getUTCSeconds()).padStart(2,"0")+"."+String(r.getUTCMilliseconds()).padStart(3,"0");return s+="+00:00",t&&(s+=" BC"),s}function Jn(r,e,t){return r=typeof r=="string"?{text:r}:r,e&&(typeof e=="function"?r.callback=e:r.values=e),t&&(r.callback=t),r}var Zn=function(r){return'"'+r.replace(/"/g,'""')+'"'},Xn=function(r){for(var e=!1,t="'",s=0;s<r.length;s++){var n=r[s];n==="'"?t+=n+n:n==="\\"?(t+=n+n,e=!0):t+=n}return t+="'",e===!0&&(t=" E"+t),t};vr.exports={prepareValue:function(e){return _e(e)},normalizeQueryConfig:Jn,escapeIdentifier:Zn,escapeLiteral:Xn}});function ti(){return globalThis.crypto.randomUUID()}function ri(r,e,t){return e!==void 0&&(t!==void 0?r=r.subarray(e,e+t):r=r.subarray(e)),globalThis.crypto.getRandomValues(r)}function si(r){return new be(r)}var ei,be,br=D(()=>{"use strict";o();u();c();ei=globalThis.crypto;be=class{#e=[];#t;constructor(e){this.#t=e}update(e){this.#e.push(e)}async digest(){let e=new Uint8Array(this.#e.reduce((n,i)=>n+i.length,0)),t=0;for(let n of this.#e)e.set(n,t),t+=n.length;let s=await globalThis.crypto.subtle.digest(this.#t,e);return new Uint8Array(s)}}});var ze={};ye(ze,{Hash:()=>be,createHash:()=>si,randomFillSync:()=>ri,randomUUID:()=>ti,webcrypto:()=>ei});var Ve=D(()=>{"use strict";o();u();c();br()});var Cr=w((vu,Er)=>{"use strict";o();u();c();var $=(Ve(),P(ze));function Ye(r){return $.createHash("md5").update(r,"utf-8").digest("hex")}function ni(r,e,t){var s=Ye(e+r),n=Ye(h.Buffer.concat([h.Buffer.from(s),t]));return"md5"+n}function ii(r){return $.createHash("sha256").update(r).digest()}function ai(r,e){return r=r.replace(/(\D)-/,"$1"),$.createHash(r).update(e).digest()}function oi(r,e){return $.createHmac("sha256",r).update(e).digest()}async function ui(r,e,t){return $.pbkdf2Sync(r,e,t,32,"sha256")}Er.exports={postgresMd5PasswordHash:ni,randomBytes:$.randomBytes,deriveKey:ui,sha256:ii,hashByName:ai,hmacSha256:oi,md5:Ye}});var Mr=w((Au,Pr)=>{"use strict";o();u();c();var Ar=(Ve(),P(ze));Pr.exports={postgresMd5PasswordHash:hi,randomBytes:ci,deriveKey:pi,sha256:li,hashByName:fi,hmacSha256:di,md5:$e};var xr=Ar.webcrypto||globalThis.crypto,W=xr.subtle,Je=new TextEncoder;function ci(r){return xr.getRandomValues(h.Buffer.alloc(r))}async function $e(r){try{return Ar.createHash("md5").update(r,"utf-8").digest("hex")}catch{let t=typeof r=="string"?Je.encode(r):r,s=await W.digest("MD5",t);return Array.from(new Uint8Array(s)).map(n=>n.toString(16).padStart(2,"0")).join("")}}async function hi(r,e,t){var s=await $e(e+r),n=await $e(h.Buffer.concat([h.Buffer.from(s),t]));return"md5"+n}async function li(r){return await W.digest("SHA-256",r)}async function fi(r,e){return await W.digest(r,e)}async function di(r,e){let t=await W.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await W.sign("HMAC",t,Je.encode(e))}async function pi(r,e,t){let s=await W.importKey("raw",Je.encode(r),"PBKDF2",!1,["deriveBits"]),n={name:"PBKDF2",hash:"SHA-256",salt:e,iterations:t};return await W.deriveBits(n,s,32*8,["deriveBits"])}});var Xe=w((Tu,Ze)=>{"use strict";o();u();c();var mi=parseInt(f.versions&&f.versions.node&&f.versions.node.split(".")[0])<15;mi?Ze.exports=Cr():Ze.exports=Mr()});var Rr=w((Du,Ir)=>{"use strict";o();u();c();function K(r,e){throw new Error("SASL channel binding: "+r+" when parsing public certificate "+e.toString("base64"))}function et(r,e){let t=r[e++];if(t<128)return{length:t,index:e};let s=t&127;s>4&&K("bad length",r),t=0;for(let n=0;n<s;n++)t=t<<8|r[e++];return{length:t,index:e}}function Tr(r,e){r[e++]!==6&&K("non-OID data",r);let{length:t,index:s}=et(r,e);e=s,lastIndex=e+t;let n=r[e++],i=(n/40>>0)+"."+n%40;for(;e<lastIndex;){let a=0;for(;e<lastIndex;){let l=r[e++];if(a=a<<7|l&127,l<128)break}i+="."+a}return{oid:i,index:e}}function ce(r,e){return r[e++]!==48&&K("non-sequence data",r),et(r,e)}function yi(r,e){e===void 0&&(e=0),e=ce(r,e).index;let{length:t,index:s}=ce(r,e);e=s+t,e=ce(r,e).index;let{oid:n,index:i}=Tr(r,e);switch(n){case"1.2.840.113549.1.1.4":return"MD5";case"1.2.840.113549.1.1.5":return"SHA-1";case"1.2.840.113549.1.1.11":return"SHA-256";case"1.2.840.113549.1.1.12":return"SHA-384";case"1.2.840.113549.1.1.13":return"SHA-512";case"1.2.840.113549.1.1.14":return"SHA-224";case"1.2.840.113549.1.1.15":return"SHA512-224";case"1.2.840.113549.1.1.16":return"SHA512-256";case"1.2.840.10045.4.1":return"SHA-1";case"1.2.840.10045.4.3.1":return"SHA-224";case"1.2.840.10045.4.3.2":return"SHA-256";case"1.2.840.10045.4.3.3":return"SHA-384";case"1.2.840.10045.4.3.4":return"SHA-512";case"1.2.840.113549.1.1.10":e=i,e=ce(r,e).index,r[e++]!==160&&K("non-tag data",r),e=et(r,e).index,e=ce(r,e).index;let{oid:a}=Tr(r,e);switch(a){case"1.2.840.113549.2.5":return"MD5";case"1.3.14.3.2.26":return"SHA-1";case"2.16.840.1.101.3.4.2.1":return"SHA-256";case"2.16.840.1.101.3.4.2.2":return"SHA-384";case"2.16.840.1.101.3.4.2.3":return"SHA-512"}K("unknown hash OID "+a,r);case"1.3.101.110":case"1.3.101.112":return"SHA-512";case"1.3.101.111":case"1.3.101.113":K("Ed448 certificate channel binding is not currently supported by Postgres")}K("unknown OID "+n,r)}Ir.exports={signatureAlgorithmHashFromCertificate:yi}});var Or=w((Bu,Lr)=>{"use strict";o();u();c();var Q=Xe(),{signatureAlgorithmHashFromCertificate:gi}=Rr();function Si(r,e){let t=["SCRAM-SHA-256"];e&&t.unshift("SCRAM-SHA-256-PLUS");let s=t.find(a=>r.includes(a));if(!s)throw new Error("SASL: Only mechanism(s) "+t.join(" and ")+" are supported");if(s==="SCRAM-SHA-256-PLUS"&&typeof e.getPeerCertificate!="function")throw new Error("SASL: Mechanism SCRAM-SHA-256-PLUS requires a certificate");let n=Q.randomBytes(18).toString("base64");return{mechanism:s,clientNonce:n,response:(s==="SCRAM-SHA-256-PLUS"?"p=tls-server-end-point":e?"y":"n")+",,n=*,r="+n,message:"SASLInitialResponse"}}async function wi(r,e,t,s){if(r.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(e==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof t!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let n=bi(t);if(n.nonce.startsWith(r.clientNonce)){if(n.nonce.length===r.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var i="n=*,r="+r.clientNonce,a="r="+n.nonce+",s="+n.salt+",i="+n.iteration;let l=s?"eSws":"biws";if(r.mechanism==="SCRAM-SHA-256-PLUS"){let Gt=s.getPeerCertificate().raw,de=gi(Gt);(de==="MD5"||de==="SHA-1")&&(de="SHA-256");let Ws=await Q.hashByName(de,Gt);l=h.Buffer.concat([h.Buffer.from("p=tls-server-end-point,,"),h.Buffer.from(Ws)]).toString("base64")}var p="c="+l+",r="+n.nonce,d=i+","+a+","+p,S=h.Buffer.from(n.salt,"base64"),v=await Q.deriveKey(e,S,n.iteration),b=await Q.hmacSha256(v,"Client Key"),I=await Q.sha256(b),Le=await Q.hmacSha256(I,d),Oe=Ci(h.Buffer.from(b),h.Buffer.from(Le)).toString("base64"),js=await Q.hmacSha256(v,"Server Key"),Gs=await Q.hmacSha256(js,d);r.message="SASLResponse",r.serverSignature=h.Buffer.from(Gs).toString("base64"),r.response=p+",p="+Oe}function _i(r,e){if(r.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:t}=Ei(e);if(t!==r.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function vi(r){if(typeof r!="string")throw new TypeError("SASL: text must be a string");return r.split("").map((e,t)=>r.charCodeAt(t)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}function kr(r){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(r)}function Dr(r){if(typeof r!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(r.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let t=e[0],s=e.substring(2);return[t,s]}))}function bi(r){let e=Dr(r),t=e.get("r");if(t){if(!vi(t))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let s=e.get("s");if(s){if(!kr(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let n=e.get("i");if(n){if(!/^[1-9][0-9]*$/.test(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let i=parseInt(n,10);return{nonce:t,salt:s,iteration:i}}function Ei(r){let t=Dr(r).get("v");if(t){if(!kr(t))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:t}}function Ci(r,e){if(!h.Buffer.isBuffer(r))throw new TypeError("first argument must be a Buffer");if(!h.Buffer.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(r.length!==e.length)throw new Error("Buffer lengths must match");if(r.length===0)throw new Error("Buffers cannot be empty");return h.Buffer.from(r.map((t,s)=>r[s]^e[s]))}Lr.exports={startSession:Si,continueSession:wi,finalizeSession:_i}});var Br=w((Uu,qr)=>{"use strict";o();u();c();var Ai=oe();function Ee(r){this._types=r||Ai,this.text={},this.binary={}}Ee.prototype.getOverrides=function(r){switch(r){case"text":return this.text;case"binary":return this.binary;default:return{}}};Ee.prototype.setTypeParser=function(r,e,t){typeof e=="function"&&(t=e,e="text"),this.getOverrides(e)[r]=t};Ee.prototype.getTypeParser=function(r,e){return e=e||"text",this.getOverrides(e)[r]||this._types.getTypeParser(r,e)};qr.exports=Ee});var Fr=w(()=>{"use strict";o();u();c()});var rt={};ye(rt,{chmodSync:()=>Wr,default:()=>Pi,existsSync:()=>Nr,lstatSync:()=>tt,mkdirSync:()=>zr,promises:()=>Jr,readdir:()=>Hr,readdirSync:()=>Ur,readlinkSync:()=>jr,realpathSync:()=>Gr,renameSync:()=>Kr,rmSync:()=>Yr,rmdirSync:()=>Vr,statSync:()=>Qr,unlinkSync:()=>$r});function Nr(){return!1}function tt(){return{dev:0,ino:0,mode:0,nlink:0,uid:0,gid:0,rdev:0,size:0,blksize:0,blocks:0,atimeMs:0,mtimeMs:0,ctimeMs:0,birthtimeMs:0,atime:new Date,mtime:new Date,ctime:new Date,birthtime:new Date}}function Qr(){return tt()}function Ur(){return[]}function Hr(r){r(null,[])}function jr(){return""}function Gr(){return""}function Wr(){}function Kr(){}function zr(){}function Vr(){}function Yr(){}function $r(){}var Jr,xi,Pi,st=D(()=>{"use strict";o();u();c();Jr={},xi={existsSync:Nr,lstatSync:tt,statSync:Qr,readdirSync:Ur,readdir:Hr,readlinkSync:jr,realpathSync:Gr,chmodSync:Wr,renameSync:Kr,mkdirSync:zr,rmdirSync:Vr,rmSync:Yr,unlinkSync:$r,promises:Jr},Pi=xi});var Xr=w((Xu,Zr)=>{"use strict";o();u();c();function nt(r){if(r.charAt(0)==="/"){let l=r.split(" ");return{host:l[0],database:l[1]}}let e={},t,s=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(r)&&(r=encodeURI(r).replace(/\%25(\d\d)/g,"%$1"));try{t=new URL(r,"postgres://base")}catch{t=new URL(r.replace("@/","@___DUMMY___/"),"postgres://base"),s=!0}for(let l of t.searchParams.entries())e[l[0]]=l[1];if(e.user=e.user||decodeURIComponent(t.username),e.password=e.password||decodeURIComponent(t.password),t.protocol=="socket:")return e.host=decodeURI(t.pathname),e.database=t.searchParams.get("db"),e.client_encoding=t.searchParams.get("encoding"),e;let n=s?"":t.hostname;e.host?n&&/^%2f/i.test(n)&&(t.pathname=n+t.pathname):e.host=decodeURIComponent(n),e.port||(e.port=t.port);let i=t.pathname.slice(1)||null;e.database=i?decodeURI(i):null,(e.ssl==="true"||e.ssl==="1")&&(e.ssl=!0),e.ssl==="0"&&(e.ssl=!1),(e.sslcert||e.sslkey||e.sslrootcert||e.sslmode)&&(e.ssl={});let a=e.sslcert||e.sslkey||e.sslrootcert?(st(),P(rt)):null;switch(e.sslcert&&(e.ssl.cert=a.readFileSync(e.sslcert).toString()),e.sslkey&&(e.ssl.key=a.readFileSync(e.sslkey).toString()),e.sslrootcert&&(e.ssl.ca=a.readFileSync(e.sslrootcert).toString()),e.sslmode){case"disable":{e.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{e.ssl.rejectUnauthorized=!1;break}}return e}Zr.exports=nt;nt.parse=nt});var ss=w((sc,rs)=>{"use strict";o();u();c();var Mi=Fr(),ts=ue(),es=Xr().parse,M=function(r,e,t){return t===void 0?t=f.env["PG"+r.toUpperCase()]:t===!1||(t=f.env[t]),e[r]||t||ts[r]},Ti=function(){switch(f.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return ts.ssl},J=function(r){return"'"+(""+r).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},O=function(r,e,t){var s=e[t];s!=null&&r.push(t+"="+J(s))},it=class{constructor(e){e=typeof e=="string"?es(e):e||{},e.connectionString&&(e=Object.assign({},e,es(e.connectionString))),this.user=M("user",e),this.database=M("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(M("port",e),10),this.host=M("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:M("password",e)}),this.binary=M("binary",e),this.options=M("options",e),this.ssl=typeof e.ssl>"u"?Ti():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=M("client_encoding",e),this.replication=M("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=M("application_name",e,"PGAPPNAME"),this.fallback_application_name=M("fallback_application_name",e,!1),this.statement_timeout=M("statement_timeout",e,!1),this.lock_timeout=M("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=M("idle_in_transaction_session_timeout",e,!1),this.query_timeout=M("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=f.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){var t=[];O(t,this,"user"),O(t,this,"password"),O(t,this,"port"),O(t,this,"application_name"),O(t,this,"fallback_application_name"),O(t,this,"connect_timeout"),O(t,this,"options");var s=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(O(t,s,"sslmode"),O(t,s,"sslca"),O(t,s,"sslkey"),O(t,s,"sslcert"),O(t,s,"sslrootcert"),this.database&&t.push("dbname="+J(this.database)),this.replication&&t.push("replication="+J(this.replication)),this.host&&t.push("host="+J(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+J(this.client_encoding)),Mi.lookup(this.host,function(n,i){return n?e(n,null):(t.push("hostaddr="+J(i)),e(null,t.join(" ")))})}};rs.exports=it});var as=w((oc,is)=>{"use strict";o();u();c();var Ii=oe(),ns=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,at=class{constructor(e,t){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=t,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray),this._prebuiltEmptyResultObject=null}addCommandComplete(e){var t;e.text?t=ns.exec(e.text):t=ns.exec(e.command),t&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}_parseRowAsArray(e){for(var t=new Array(e.length),s=0,n=e.length;s<n;s++){var i=e[s];i!==null?t[s]=this._parsers[s](i):t[s]=null}return t}parseRow(e){for(var t={...this._prebuiltEmptyResultObject},s=0,n=e.length;s<n;s++){var i=e[s],a=this.fields[s].name;i!==null?t[a]=this._parsers[s](i):t[a]=null}return t}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));for(var t={},s=0;s<e.length;s++){var n=e[s];t[n.name]=null,this._types?this._parsers[s]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[s]=Ii.getTypeParser(n.dataTypeID,n.format||"text")}this._prebuiltEmptyResultObject={...t}}};is.exports=at});var hs=w((lc,cs)=>{"use strict";o();u();c();var{EventEmitter:Ri}=(z(),P(R)),os=as(),us=ve(),ot=class extends Ri{constructor(e,t,s){super(),e=us.normalizeQueryConfig(e,t,s),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.queryMode=e.queryMode,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,f.domain&&e.callback&&(this.callback=f.domain.bind(e.callback)),this._result=new os(this._rowMode,this.types),this._results=this._result,this._canceledDueToError=!1}requiresPreparation(){return this.queryMode==="extended"||this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new os(this._rowMode,this._result._types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(s){this._canceledDueToError=s;return}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}handleCommandComplete(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(t){f.nextTick(()=>{throw t})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let t=e.parsedStatements[this.name];if(this.text&&t&&this.text!==t)return new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);if(this.values&&!Array.isArray(this.values))return new Error("Query values must be an array");if(this.requiresPreparation()){e.stream.cork&&e.stream.cork();try{this.prepare(e)}finally{e.stream.uncork&&e.stream.uncork()}}else e.query(this.text);return null}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}prepare(e){this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:us.prepareValue})}catch(t){this.handleError(t,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,t){}};cs.exports=ot});var bt=w(g=>{"use strict";o();u();c();Object.defineProperty(g,"__esModule",{value:!0});g.NoticeMessage=g.DataRowMessage=g.CommandCompleteMessage=g.ReadyForQueryMessage=g.NotificationResponseMessage=g.BackendKeyDataMessage=g.AuthenticationMD5Password=g.ParameterStatusMessage=g.ParameterDescriptionMessage=g.RowDescriptionMessage=g.Field=g.CopyResponse=g.CopyDataMessage=g.DatabaseError=g.copyDone=g.emptyQuery=g.replicationStart=g.portalSuspended=g.noData=g.closeComplete=g.bindComplete=g.parseComplete=void 0;g.parseComplete={name:"parseComplete",length:5};g.bindComplete={name:"bindComplete",length:5};g.closeComplete={name:"closeComplete",length:5};g.noData={name:"noData",length:5};g.portalSuspended={name:"portalSuspended",length:5};g.replicationStart={name:"replicationStart",length:4};g.emptyQuery={name:"emptyQuery",length:4};g.copyDone={name:"copyDone",length:4};var ut=class extends Error{constructor(e,t,s){super(e),this.length=t,this.name=s}};g.DatabaseError=ut;var ct=class{constructor(e,t){this.length=e,this.chunk=t,this.name="copyData"}};g.CopyDataMessage=ct;var ht=class{constructor(e,t,s,n){this.length=e,this.name=t,this.binary=s,this.columnTypes=new Array(n)}};g.CopyResponse=ht;var lt=class{constructor(e,t,s,n,i,a,l){this.name=e,this.tableID=t,this.columnID=s,this.dataTypeID=n,this.dataTypeSize=i,this.dataTypeModifier=a,this.format=l}};g.Field=lt;var ft=class{constructor(e,t){this.length=e,this.fieldCount=t,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};g.RowDescriptionMessage=ft;var dt=class{constructor(e,t){this.length=e,this.parameterCount=t,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};g.ParameterDescriptionMessage=dt;var pt=class{constructor(e,t,s){this.length=e,this.parameterName=t,this.parameterValue=s,this.name="parameterStatus"}};g.ParameterStatusMessage=pt;var mt=class{constructor(e,t){this.length=e,this.salt=t,this.name="authenticationMD5Password"}};g.AuthenticationMD5Password=mt;var yt=class{constructor(e,t,s){this.length=e,this.processID=t,this.secretKey=s,this.name="backendKeyData"}};g.BackendKeyDataMessage=yt;var gt=class{constructor(e,t,s,n){this.length=e,this.processId=t,this.channel=s,this.payload=n,this.name="notification"}};g.NotificationResponseMessage=gt;var St=class{constructor(e,t){this.length=e,this.status=t,this.name="readyForQuery"}};g.ReadyForQueryMessage=St;var wt=class{constructor(e,t){this.length=e,this.text=t,this.name="commandComplete"}};g.CommandCompleteMessage=wt;var _t=class{constructor(e,t){this.length=e,this.fields=t,this.name="dataRow",this.fieldCount=t.length}};g.DataRowMessage=_t;var vt=class{constructor(e,t){this.length=e,this.message=t,this.name="notice"}};g.NoticeMessage=vt});var ls=w(Ce=>{"use strict";o();u();c();Object.defineProperty(Ce,"__esModule",{value:!0});Ce.Writer=void 0;var Et=class{constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=h.Buffer.allocUnsafe(e)}ensure(e){var t=this.buffer.length-this.offset;if(t<e){var s=this.buffer,n=s.length+(s.length>>1)+e;this.buffer=h.Buffer.allocUnsafe(n),s.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{var t=h.Buffer.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}return this.buffer[this.offset++]=0,this}addString(e=""){var t=h.Buffer.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){var t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=h.Buffer.allocUnsafe(this.size),t}};Ce.Writer=Et});var ds=w(xe=>{"use strict";o();u();c();Object.defineProperty(xe,"__esModule",{value:!0});xe.serialize=void 0;var Ct=ls(),C=new Ct.Writer,ki=r=>{C.addInt16(3).addInt16(0);for(let s of Object.keys(r))C.addCString(s).addCString(r[s]);C.addCString("client_encoding").addCString("UTF8");var e=C.addCString("").flush(),t=e.length+4;return new Ct.Writer().addInt32(t).add(e).flush()},Di=()=>{let r=h.Buffer.allocUnsafe(8);return r.writeInt32BE(8,0),r.writeInt32BE(80877103,4),r},Li=r=>C.addCString(r).flush(112),Oi=function(r,e){return C.addCString(r).addInt32(h.Buffer.byteLength(e)).addString(e),C.flush(112)},qi=function(r){return C.addString(r).flush(112)},Bi=r=>C.addCString(r).flush(81),fs=[],Fi=r=>{let e=r.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let t=r.types||fs;for(var s=t.length,n=C.addCString(e).addCString(r.text).addInt16(s),i=0;i<s;i++)n.addInt32(t[i]);return C.flush(80)},Z=new Ct.Writer,Ni=function(r,e){for(let t=0;t<r.length;t++){let s=e?e(r[t],t):r[t];s==null?(C.addInt16(0),Z.addInt32(-1)):s instanceof h.Buffer?(C.addInt16(1),Z.addInt32(s.length),Z.add(s)):(C.addInt16(0),Z.addInt32(h.Buffer.byteLength(s)),Z.addString(s))}},Qi=(r={})=>{let e=r.portal||"",t=r.statement||"",s=r.binary||!1,n=r.values||fs,i=n.length;return C.addCString(e).addCString(t),C.addInt16(i),Ni(n,r.valueMapper),C.addInt16(i),C.add(Z.flush()),C.addInt16(s?1:0),C.flush(66)},Ui=h.Buffer.from([69,0,0,0,9,0,0,0,0,0]),Hi=r=>{if(!r||!r.portal&&!r.rows)return Ui;let e=r.portal||"",t=r.rows||0,s=h.Buffer.byteLength(e),n=4+s+1+4,i=h.Buffer.allocUnsafe(1+n);return i[0]=69,i.writeInt32BE(n,1),i.write(e,5,"utf-8"),i[s+5]=0,i.writeUInt32BE(t,i.length-4),i},ji=(r,e)=>{let t=h.Buffer.allocUnsafe(16);return t.writeInt32BE(16,0),t.writeInt16BE(1234,4),t.writeInt16BE(5678,6),t.writeInt32BE(r,8),t.writeInt32BE(e,12),t},At=(r,e)=>{let s=4+h.Buffer.byteLength(e)+1,n=h.Buffer.allocUnsafe(1+s);return n[0]=r,n.writeInt32BE(s,1),n.write(e,5,"utf-8"),n[s]=0,n},Gi=C.addCString("P").flush(68),Wi=C.addCString("S").flush(68),Ki=r=>r.name?At(68,`${r.type}${r.name||""}`):r.type==="P"?Gi:Wi,zi=r=>{let e=`${r.type}${r.name||""}`;return At(67,e)},Vi=r=>C.add(r).flush(100),Yi=r=>At(102,r),Ae=r=>h.Buffer.from([r,0,0,0,4]),$i=Ae(72),Ji=Ae(83),Zi=Ae(88),Xi=Ae(99),ea={startup:ki,password:Li,requestSsl:Di,sendSASLInitialResponseMessage:Oi,sendSCRAMClientFinalMessage:qi,query:Bi,parse:Fi,bind:Qi,execute:Hi,describe:Ki,close:zi,flush:()=>$i,sync:()=>Ji,end:()=>Zi,copyData:Vi,copyDone:()=>Xi,copyFail:Yi,cancel:ji};xe.serialize=ea});var ps=w(Pe=>{"use strict";o();u();c();Object.defineProperty(Pe,"__esModule",{value:!0});Pe.BufferReader=void 0;var ta=h.Buffer.allocUnsafe(0),xt=class{constructor(e=0){this.offset=e,this.buffer=ta,this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}uint32(){let e=this.buffer.readUInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;this.buffer[t++]!==0;);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};Pe.BufferReader=xt});var gs=w(Me=>{"use strict";o();u();c();Object.defineProperty(Me,"__esModule",{value:!0});Me.Parser=void 0;var A=bt(),ra=ps(),Pt=1,sa=4,ms=Pt+sa,ys=h.Buffer.allocUnsafe(0),Mt=class{constructor(e){if(this.buffer=ys,this.bufferLength=0,this.bufferOffset=0,this.reader=new ra.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let s=this.bufferOffset+this.bufferLength,n=this.bufferOffset;for(;n+ms<=s;){let i=this.buffer[n],a=this.buffer.readUInt32BE(n+Pt),l=Pt+a;if(l+n<=s){let p=this.handlePacket(n+ms,i,a,this.buffer);t(p),n+=l}else break}n===s?(this.buffer=ys,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=s-n,this.bufferOffset=n)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let n;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)n=this.buffer;else{let i=this.buffer.byteLength*2;for(;t>=i;)i*=2;n=h.Buffer.allocUnsafe(i)}this.buffer.copy(n,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=n,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,t,s,n){switch(t){case 50:return A.bindComplete;case 49:return A.parseComplete;case 51:return A.closeComplete;case 110:return A.noData;case 115:return A.portalSuspended;case 99:return A.copyDone;case 87:return A.replicationStart;case 73:return A.emptyQuery;case 68:return this.parseDataRowMessage(e,s,n);case 67:return this.parseCommandCompleteMessage(e,s,n);case 90:return this.parseReadyForQueryMessage(e,s,n);case 65:return this.parseNotificationMessage(e,s,n);case 82:return this.parseAuthenticationResponse(e,s,n);case 83:return this.parseParameterStatusMessage(e,s,n);case 75:return this.parseBackendKeyData(e,s,n);case 69:return this.parseErrorMessage(e,s,n,"error");case 78:return this.parseErrorMessage(e,s,n,"notice");case 84:return this.parseRowDescriptionMessage(e,s,n);case 116:return this.parseParameterDescriptionMessage(e,s,n);case 71:return this.parseCopyInMessage(e,s,n);case 72:return this.parseCopyOutMessage(e,s,n);case 100:return this.parseCopyData(e,s,n);default:return new A.DatabaseError("received invalid response: "+t.toString(16),s,"error")}}parseReadyForQueryMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.string(1);return new A.ReadyForQueryMessage(t,n)}parseCommandCompleteMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.cstring();return new A.CommandCompleteMessage(t,n)}parseCopyData(e,t,s){let n=s.slice(e,e+(t-4));return new A.CopyDataMessage(t,n)}parseCopyInMessage(e,t,s){return this.parseCopyMessage(e,t,s,"copyInResponse")}parseCopyOutMessage(e,t,s){return this.parseCopyMessage(e,t,s,"copyOutResponse")}parseCopyMessage(e,t,s,n){this.reader.setBuffer(e,s);let i=this.reader.byte()!==0,a=this.reader.int16(),l=new A.CopyResponse(t,n,i,a);for(let p=0;p<a;p++)l.columnTypes[p]=this.reader.int16();return l}parseNotificationMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),i=this.reader.cstring(),a=this.reader.cstring();return new A.NotificationResponseMessage(t,n,i,a)}parseRowDescriptionMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),i=new A.RowDescriptionMessage(t,n);for(let a=0;a<n;a++)i.fields[a]=this.parseField();return i}parseField(){let e=this.reader.cstring(),t=this.reader.uint32(),s=this.reader.int16(),n=this.reader.uint32(),i=this.reader.int16(),a=this.reader.int32(),l=this.reader.int16()===0?"text":"binary";return new A.Field(e,t,s,n,i,a,l)}parseParameterDescriptionMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),i=new A.ParameterDescriptionMessage(t,n);for(let a=0;a<n;a++)i.dataTypeIDs[a]=this.reader.int32();return i}parseDataRowMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),i=new Array(n);for(let a=0;a<n;a++){let l=this.reader.int32();i[a]=l===-1?null:this.reader.string(l)}return new A.DataRowMessage(t,i)}parseParameterStatusMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.cstring(),i=this.reader.cstring();return new A.ParameterStatusMessage(t,n,i)}parseBackendKeyData(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),i=this.reader.int32();return new A.BackendKeyDataMessage(t,n,i)}parseAuthenticationResponse(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),i={name:"authenticationOk",length:t};switch(n){case 0:break;case 3:i.length===8&&(i.name="authenticationCleartextPassword");break;case 5:if(i.length===12){i.name="authenticationMD5Password";let l=this.reader.bytes(4);return new A.AuthenticationMD5Password(t,l)}break;case 10:i.name="authenticationSASL",i.mechanisms=[];let a;do a=this.reader.cstring(),a&&i.mechanisms.push(a);while(a);break;case 11:i.name="authenticationSASLContinue",i.data=this.reader.string(t-8);break;case 12:i.name="authenticationSASLFinal",i.data=this.reader.string(t-8);break;default:throw new Error("Unknown authenticationOk message type "+n)}return i}parseErrorMessage(e,t,s,n){this.reader.setBuffer(e,s);let i={},a=this.reader.string(1);for(;a!=="\0";)i[a]=this.reader.cstring(),a=this.reader.string(1);let l=i.M,p=n==="notice"?new A.NoticeMessage(t,l):new A.DatabaseError(l,t,n);return p.severity=i.S,p.code=i.C,p.detail=i.D,p.hint=i.H,p.position=i.P,p.internalPosition=i.p,p.internalQuery=i.q,p.where=i.W,p.schema=i.s,p.table=i.t,p.column=i.c,p.dataType=i.d,p.constraint=i.n,p.file=i.F,p.line=i.L,p.routine=i.R,p}};Me.Parser=Mt});var Tt=w(U=>{"use strict";o();u();c();Object.defineProperty(U,"__esModule",{value:!0});U.DatabaseError=U.serialize=U.parse=void 0;var na=bt();Object.defineProperty(U,"DatabaseError",{enumerable:!0,get:function(){return na.DatabaseError}});var ia=ds();Object.defineProperty(U,"serialize",{enumerable:!0,get:function(){return ia.serialize}});var aa=gs();function oa(r,e){let t=new aa.Parser;return r.on("data",s=>t.parse(s,e)),new Promise(s=>r.on("end",()=>s()))}U.parse=oa});var It=w(()=>{"use strict";o();u();c()});var Ss=w(()=>{"use strict";o();u();c()});var ws={};ye(ws,{CloudflareSocket:()=>Rt});function ca(r){if(r instanceof Uint8Array||r instanceof ArrayBuffer){let e=h.Buffer.from(r).toString("hex");return`
>>> STR: "${new TextDecoder().decode(r).replace(/\n/g,"\\n")}"
>>> HEX: ${e}
`}else return r}function k(...r){ua&&console.log(...r.map(ca))}var Rt,ua,_s=D(()=>{"use strict";o();u();c();z();Rt=class extends R.EventEmitter{constructor(e){super(),this.ssl=e,this.writable=!1,this.destroyed=!1,this._upgrading=!1,this._upgraded=!1,this._cfSocket=null,this._cfWriter=null,this._cfReader=null}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}async connect(e,t,s){try{k("connecting"),s&&this.once("connect",s);let n=this.ssl?{secureTransport:"starttls"}:{},{connect:i}=await import("cloudflare:sockets");return this._cfSocket=i(`${t}:${e}`,n),this._cfWriter=this._cfSocket.writable.getWriter(),this._addClosedHandler(),this._cfReader=this._cfSocket.readable.getReader(),this.ssl?this._listenOnce().catch(a=>this.emit("error",a)):this._listen().catch(a=>this.emit("error",a)),await this._cfWriter.ready,k("socket ready"),this.writable=!0,this.emit("connect"),this}catch(n){this.emit("error",n)}}async _listen(){for(;;){k("awaiting receive from CF socket");let{done:e,value:t}=await this._cfReader.read();if(k("CF socket received:",e,t),e){k("done");break}this.emit("data",h.Buffer.from(t))}}async _listenOnce(){k("awaiting first receive from CF socket");let{done:e,value:t}=await this._cfReader.read();k("First CF socket received:",e,t),this.emit("data",h.Buffer.from(t))}write(e,t="utf8",s=()=>{}){return e.length===0?s():(typeof e=="string"&&(e=h.Buffer.from(e,t)),k("sending data direct:",e),this._cfWriter.write(e).then(()=>{k("data sent"),s()},n=>{k("send error",n),s(n)}),!0)}end(e=h.Buffer.alloc(0),t="utf8",s=()=>{}){return k("ending CF socket"),this.write(e,t,n=>{this._cfSocket.close(),s&&s(n)}),this}destroy(e){return k("destroying CF socket",e),this.destroyed=!0,this.end()}startTls(e){if(this._upgraded){this.emit("error","Cannot call `startTls()` more than once on a socket");return}this._cfWriter.releaseLock(),this._cfReader.releaseLock(),this._upgrading=!0,this._cfSocket=this._cfSocket.startTls(e),this._cfWriter=this._cfSocket.writable.getWriter(),this._cfReader=this._cfSocket.readable.getReader(),this._addClosedHandler(),this._listen().catch(t=>this.emit("error",t))}_addClosedHandler(){this._cfSocket.closed.then(()=>{this._upgrading?(this._upgrading=!1,this._upgraded=!0):(k("CF socket closed"),this._cfSocket=null,this.emit("close"))}).catch(e=>this.emit("error",e))}},ua=!1});var bs=w((Xc,vs)=>{"use strict";o();u();c();var{getStream:ha,getSecureStream:la}=ma();vs.exports={getStream:ha,getSecureStream:la};function fa(){function r(t){let s=It();return new s.Socket}function e(t){var s=Ss();return s.connect(t)}return{getStream:r,getSecureStream:e}}function da(){function r(t){let{CloudflareSocket:s}=(_s(),P(ws));return new s(t)}function e(t){return t.socket.startTls(t),t.socket}return{getStream:r,getSecureStream:e}}function pa(){if(typeof navigator=="object"&&navigator!==null&&typeof navigator.userAgent=="string")return navigator.userAgent==="Cloudflare-Workers";if(typeof Response=="function"){let r=new Response(null,{cf:{thing:!0}});if(typeof r.cf=="object"&&r.cf!==null&&r.cf.thing)return!0}return!1}function ma(){return pa()?da():fa()}});var Dt=w((sh,Es)=>{"use strict";o();u();c();var ya=(z(),P(R)).EventEmitter,{parse:ga,serialize:x}=Tt(),{getStream:Sa,getSecureStream:wa}=bs(),_a=x.flush(),va=x.sync(),ba=x.end(),kt=class extends ya{constructor(e){super(),e=e||{},this.stream=e.stream||Sa(e.ssl),typeof this.stream=="function"&&(this.stream=this.stream(e)),this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;var t=this;this.on("newListener",function(s){s==="message"&&(t._emitMessage=!0)})}connect(e,t){var s=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",function(){s._keepAlive&&s.stream.setKeepAlive(!0,s._keepAliveInitialDelayMillis),s.emit("connect")});let n=function(i){s._ending&&(i.code==="ECONNRESET"||i.code==="EPIPE")||s.emit("error",i)};if(this.stream.on("error",n),this.stream.on("close",function(){s.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(i){var a=i.toString("utf8");switch(a){case"S":break;case"N":return s.stream.end(),s.emit("error",new Error("The server does not support SSL connections"));default:return s.stream.end(),s.emit("error",new Error("There was an error establishing an SSL connection"))}let l={socket:s.stream};s.ssl!==!0&&(Object.assign(l,s.ssl),"key"in s.ssl&&(l.key=s.ssl.key));var p=It();p.isIP&&p.isIP(t)===0&&(l.servername=t);try{s.stream=wa(l)}catch(d){return s.emit("error",d)}s.attachListeners(s.stream),s.stream.on("error",n),s.emit("sslconnect")})}attachListeners(e){ga(e,t=>{var s=t.name==="error"?"errorMessage":t.name;this._emitMessage&&this.emit("message",t),this.emit(s,t)})}requestSsl(){this.stream.write(x.requestSsl())}startup(e){this.stream.write(x.startup(e))}cancel(e,t){this._send(x.cancel(e,t))}password(e){this._send(x.password(e))}sendSASLInitialResponseMessage(e,t){this._send(x.sendSASLInitialResponseMessage(e,t))}sendSCRAMClientFinalMessage(e){this._send(x.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(x.query(e))}parse(e){this._send(x.parse(e))}bind(e){this._send(x.bind(e))}execute(e){this._send(x.execute(e))}flush(){this.stream.writable&&this.stream.write(_a)}sync(){this._ending=!0,this._send(va)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(ba,()=>{this.stream.end()})}close(e){this._send(x.close(e))}describe(e){this._send(x.describe(e))}sendCopyFromChunk(e){this._send(x.copyData(e))}endCopyFrom(){this._send(x.copyDone())}sendCopyFail(e){this._send(x.copyFail(e))}};Es.exports=kt});var B={};var Lt=D(()=>{"use strict";o();u();c();_(B,require("node:path"))});var F={};var Ot=D(()=>{"use strict";o();u();c();_(F,require("node:stream"))});var H={};var Cs=D(()=>{"use strict";o();u();c();_(H,require("node:string_decoder"))});var Ms=w((wh,Ps)=>{"use strict";o();u();c();var{Transform:Ea}=(Ot(),P(F)),{StringDecoder:Ca}=(Cs(),P(H)),j=Symbol("last"),Te=Symbol("decoder");function Aa(r,e,t){let s;if(this.overflow){if(s=this[Te].write(r).split(this.matcher),s.length===1)return t();s.shift(),this.overflow=!1}else this[j]+=this[Te].write(r),s=this[j].split(this.matcher);this[j]=s.pop();for(let n=0;n<s.length;n++)try{xs(this,this.mapper(s[n]))}catch(i){return t(i)}if(this.overflow=this[j].length>this.maxLength,this.overflow&&!this.skipOverflow){t(new Error("maximum buffer reached"));return}t()}function xa(r){if(this[j]+=this[Te].end(),this[j])try{xs(this,this.mapper(this[j]))}catch(e){return r(e)}r()}function xs(r,e){e!==void 0&&r.push(e)}function As(r){return r}function Pa(r,e,t){switch(r=r||/\r?\n/,e=e||As,t=t||{},arguments.length){case 1:typeof r=="function"?(e=r,r=/\r?\n/):typeof r=="object"&&!(r instanceof RegExp)&&!r[Symbol.split]&&(t=r,r=/\r?\n/);break;case 2:typeof r=="function"?(t=e,e=r,r=/\r?\n/):typeof e=="object"&&(t=e,e=As)}t=Object.assign({},t),t.autoDestroy=!0,t.transform=Aa,t.flush=xa,t.readableObjectMode=!0;let s=new Ea(t);return s[j]="",s[Te]=new Ca("utf8"),s.matcher=r,s.mapper=e,s.maxLength=t.maxLength,s.skipOverflow=t.skipOverflow||!1,s.overflow=!1,s._destroy=function(n,i){this._writableState.errorEmitted=!1,i(n)},s}Ps.exports=Pa});var G={};var Ts=D(()=>{"use strict";o();u();c();_(G,require("node:util"))});var ks=w((Ph,N)=>{"use strict";o();u();c();var Is=(Lt(),P(B)),Ma=(Ot(),P(F)).Stream,Ta=Ms(),Rs=(Ts(),P(G)),Ia=5432,Ie=f.platform==="win32",he=f.stderr,Ra=56,ka=7,Da=61440,La=32768;function Oa(r){return(r&Da)==La}var X=["host","port","database","user","password"],qt=X.length,qa=X[qt-1];function Bt(){var r=he instanceof Ma&&he.writable===!0;if(r){var e=Array.prototype.slice.call(arguments).concat(`
`);he.write(Rs.format.apply(Rs,e))}}Object.defineProperty(N.exports,"isWin",{get:function(){return Ie},set:function(r){Ie=r}});N.exports.warnTo=function(r){var e=he;return he=r,e};N.exports.getFileName=function(r){var e=r||f.env,t=e.PGPASSFILE||(Ie?Is.join(e.APPDATA||"./","postgresql","pgpass.conf"):Is.join(e.HOME||"./",".pgpass"));return t};N.exports.usePgPass=function(r,e){return Object.prototype.hasOwnProperty.call(f.env,"PGPASSWORD")?!1:Ie?!0:(e=e||"<unkn>",Oa(r.mode)?r.mode&(Ra|ka)?(Bt('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(Bt('WARNING: password file "%s" is not a plain file',e),!1))};var Ba=N.exports.match=function(r,e){return X.slice(0,-1).reduce(function(t,s,n){return n==1&&Number(r[s]||Ia)===Number(e[s])?t&&!0:t&&(e[s]==="*"||e[s]===r[s])},!0)};N.exports.getPassword=function(r,e,t){var s,n=e.pipe(Ta());function i(p){var d=Fa(p);d&&Na(d)&&Ba(r,d)&&(s=d[qa],n.end())}var a=function(){e.destroy(),t(s)},l=function(p){e.destroy(),Bt("WARNING: error on reading file: %s",p),t(void 0)};e.on("error",l),n.on("data",i).on("end",a).on("error",l)};var Fa=N.exports.parseLine=function(r){if(r.length<11||r.match(/^\s+#/))return null;for(var e="",t="",s=0,n=0,i=0,a={},l=!1,p=function(S,v,b){var I=r.substring(v,b);Object.hasOwnProperty.call(f.env,"PGPASS_NO_DEESCAPE")||(I=I.replace(/\\([:\\])/g,"$1")),a[X[S]]=I},d=0;d<r.length-1;d+=1){if(e=r.charAt(d+1),t=r.charAt(d),l=s==qt-1,l){p(s,n);break}d>=0&&e==":"&&t!=="\\"&&(p(s,n,d+1),n=d+2,s+=1)}return a=Object.keys(a).length===qt?a:null,a},Na=N.exports.isValidEntry=function(r){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<X.length;t+=1){var s=e[t],n=r[X[t]]||"",i=s(n);if(!i)return!1}return!0}});var Ls=w((kh,Ft)=>{"use strict";o();u();c();var Rh=(Lt(),P(B)),Ds=(st(),P(rt)),Re=ks();Ft.exports=function(r,e){var t=Re.getFileName();Ds.stat(t,function(s,n){if(s||!Re.usePgPass(n,t))return e(void 0);var i=Ds.createReadStream(t);Re.getPassword(r,i,e)})};Ft.exports.warnTo=Re.warnTo});var Fs=w((qh,Bs)=>{"use strict";o();u();c();var Qa=(z(),P(R)).EventEmitter,Os=ve(),Nt=Or(),Ua=Br(),Ha=ss(),qs=hs(),ja=ue(),Ga=Dt(),Wa=Xe(),ke=class extends Qa{constructor(e){super(),this.connectionParameters=new Ha(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var t=e||{};this._Promise=t.Promise||globalThis.Promise,this._types=new Ua(t.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!t.enableChannelBinding,this.connection=t.connection||new Ga({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||ja.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=s=>{f.nextTick(()=>{s.handleError(e,this.connection)})};this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){var t=this,s=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let n=new Error("Client has already been connected. You cannot reuse a client.");f.nextTick(()=>{e(n)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{s._ending=!0,s.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){t.ssl?s.requestSsl():s.startup(t.getStartupConf())}),s.on("sslconnect",function(){s.startup(t.getStartupConf())}),this._attachListeners(s),s.once("end",()=>{let n=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(n),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(n):this._handleErrorEvent(n):this._connectionError||this._handleErrorEvent(n)),f.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,s)=>{this._connect(n=>{n?s(n):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(s=>{if(s!==void 0){if(typeof s!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=s}else this.connectionParameters.password=this.password=null;e()}).catch(s=>{t.emit("error",s)});else if(this.password!==null)e();else try{Ls()(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}catch(s){this.emit("error",s)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let t=await Wa.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)}catch(t){this.emit("error",t)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=Nt.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(t){this.connection.emit("error",t)}})}async _handleAuthSASLContinue(e){try{await Nt.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}_handleAuthSASLFinal(e){try{Nt.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let t=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(t);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){var e=this.connectionParameters,t={user:e.user,database:e.database},s=e.application_name||e.fallback_application_name;return s&&(t.application_name=s),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){var s=this.connection;this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){s.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,s){return this._types.setTypeParser(e,t,s)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return Os.escapeIdentifier(e)}escapeLiteral(e){return Os.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&f.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,s){var n,i,a,l,p;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,i=n=e,typeof t=="function"&&(n.callback=n.callback||t)):(a=e.query_timeout||this.connectionParameters.query_timeout,n=new qs(e,t,s),n.callback||(i=new this._Promise((d,S)=>{n.callback=(v,b)=>v?S(v):d(b)}).catch(d=>{throw Error.captureStackTrace(d),d}))),a&&(p=n.callback,l=setTimeout(()=>{var d=new Error("Query read timeout");f.nextTick(()=>{n.handleError(d,this.connection)}),p(d),n.callback=()=>{};var S=this.queryQueue.indexOf(n);S>-1&&this.queryQueue.splice(S,1),this._pulseQueryQueue()},a),n.callback=(d,S)=>{clearTimeout(l),p(d,S)}),this.binary&&!n.binary&&(n.binary=!0),n._result&&!n._result._types&&(n._result._types=this._types),this._queryable?this._ending?(f.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"),this.connection)}),i):(this.queryQueue.push(n),this._pulseQueryQueue(),i):(f.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),i)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};ke.Query=qs;Bs.exports=ke});var Hs=w((Qh,Us)=>{"use strict";o();u();c();var Ka=(z(),P(R)).EventEmitter,Ns=function(){},Qs=(r,e)=>{let t=r.findIndex(e);return t===-1?void 0:r.splice(t,1)[0]},Qt=class{constructor(e,t,s){this.client=e,this.idleListener=t,this.timeoutId=s}},ee=class{constructor(e){this.callback=e}};function za(){throw new Error("Release called on client which has already been released to the pool.")}function De(r,e){if(e)return{callback:e,result:void 0};let t,s,n=function(a,l){a?t(a):s(l)},i=new r(function(a,l){s=a,t=l}).catch(a=>{throw Error.captureStackTrace(a),a});return{callback:n,result:i}}function Va(r,e){return function t(s){s.client=e,e.removeListener("error",t),e.on("error",()=>{r.log("additional client error after disconnection due to error",s)}),r._remove(e),r.emit("error",s,e)}}var Ut=class extends Ka{constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||le().Client,this.Promise=this.options.Promise||globalThis.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let s=t.client;s.ref&&s.ref();let n=t.idleListener;return this._acquireClient(s,e,n,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e){let t=Qs(this._idle,s=>s.client===e);t!==void 0&&clearTimeout(t.timeoutId),this._clients=this._clients.filter(s=>s!==e),e.end(),this.emit("remove",e)}connect(e){if(this.ending){let n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}let t=De(this.Promise,e),s=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&f.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new ee(t.callback)),s;let n=(l,p,d)=>{clearTimeout(a),t.callback(l,p,d)},i=new ee(n),a=setTimeout(()=>{Qs(this._pendingQueue,l=>l.callback===n),i.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return a.unref&&a.unref(),this._pendingQueue.push(i),s}return this.newClient(new ee(t.callback)),s}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let s=Va(this,t);this.log("checking client timeout");let n,i=!1;this.options.connectionTimeoutMillis&&(n=setTimeout(()=>{this.log("ending client due to timeout"),i=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(n&&clearTimeout(n),t.on("error",s),a)this.log("client failed to connect",a),this._clients=this._clients.filter(l=>l!==t),i&&(a=new Error("Connection terminated due to connection timeout",{cause:a})),this._pulseQueue(),e.timedOut||e.callback(a,void 0,Ns);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let l=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(d=>d.client===t)!==-1&&this._acquireClient(t,new ee((d,S,v)=>v()),s,!1)},this.options.maxLifetimeSeconds*1e3);l.unref(),t.once("end",()=>clearTimeout(l))}return this._acquireClient(t,e,s,!0)}})}_acquireClient(e,t,s,n){n&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,s),e.removeListener("error",s),t.timedOut?n&&this.options.verify?this.options.verify(e,e.release):e.release():n&&this.options.verify?this.options.verify(e,i=>{if(i)return e.release(i),t.callback(i,void 0,Ns);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let s=!1;return n=>{s&&za(),s=!0,this._release(e,t,n)}}_release(e,t,s){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",s,e),s||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses){e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e),this._pulseQueue();return}if(this._expired.has(e)){this.log("remove expired client"),this._expired.delete(e),this._remove(e),this._pulseQueue();return}let i;this.options.idleTimeoutMillis&&(i=setTimeout(()=>{this.log("remove idle client"),this._remove(e)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&i.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new Qt(e,t,i)),this._pulseQueue()}query(e,t,s){if(typeof e=="function"){let i=De(this.Promise,e);return setImmediate(function(){return i.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),i.result}typeof t=="function"&&(s=t,t=void 0);let n=De(this.Promise,s);return s=n.callback,this.connect((i,a)=>{if(i)return s(i);let l=!1,p=d=>{l||(l=!0,a.release(d),s(d))};a.once("error",p),this.log("dispatching query");try{a.query(e,t,(d,S)=>{if(this.log("query dispatched"),a.removeListener("error",p),!l)return l=!0,a.release(d),d?s(d):s(void 0,S)})}catch(d){return a.release(d),s(d)}}),n.result}end(e){if(this.log("ending"),this.ending){let s=new Error("Called end on pool more than once");return e?e(s):this.Promise.reject(s)}this.ending=!0;let t=De(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};Us.exports=Ut});var Ht=w(()=>{"use strict";o();u();c()});var le=w(($h,fe)=>{"use strict";o();u();c();var Ya=Fs(),$a=ue(),Ja=Dt(),Za=Hs(),{DatabaseError:Xa}=Tt(),{escapeIdentifier:eo,escapeLiteral:to}=ve(),ro=r=>class extends Za{constructor(t){super(t,r)}},jt=function(r){this.defaults=$a,this.Client=r,this.Query=this.Client.Query,this.Pool=ro(this.Client),this._pools=[],this.Connection=Ja,this.types=oe(),this.DatabaseError=Xa,this.escapeIdentifier=eo,this.escapeLiteral=to};typeof f.env.NODE_PG_FORCE_NATIVE<"u"?fe.exports=new jt(Ht()):(fe.exports=new jt(Ya),Object.defineProperty(fe.exports,"native",{configurable:!0,enumerable:!1,get(){var r=null;try{r=new jt(Ht())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(fe.exports,"native",{value:r}),r}}))});var q={};ye(q,{Client:()=>te.Client,Pool:()=>te.Pool,default:()=>no,types:()=>te.types});module.exports=P(q);o();u();c();var so=ge(le());_(q,ge(le()),module.exports);var te=ge(le()),no=so;0&&(module.exports={Client,Pool,types});
